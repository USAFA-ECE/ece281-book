
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lab 4 - Moore Elevator Controller &#8212; ECE 281</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/print.css?v=74670715" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lab/lab4';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lab 5 - Basic CPU" href="lab5.html" />
    <link rel="prev" title="Lab 3 - Thunderbird Turn Signal" href="lab3.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="ECE 281 - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="ECE 281 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    ECE 281: Digital Design and Computer Architecture
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">In Class Exercise</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ICE/ICE0.html">BCE 0: Get started with Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ICE/ICE1.html">ICE 1: Breadboard Half Adder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ICE/ICE2.html">ICE 2: VHDL Half-Adder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ICE/ICE3.html">ICE 3: Ripple-Carry Adder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ICE/ICE4.html">ICE 4: Stoplight</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ICE/ICE5.html">ICE 5: Basic Elevator Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ICE/ICE6.html">ICE 6: Time Division Multiplexor</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lab1.html">Lab 1 - ThirtyOneDayMonth</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab2.html">Lab 2 - Seven Segment Display Decoder</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab3.html">Lab 3 - Thunderbird Turn Signal</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lab 4 - Moore Elevator Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab5.html">Lab 5 - Basic CPU</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Homework</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../HW/HW6.html">HW 6 - Digital Schematics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendix/github.html">GitHub real fast</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/vivado.html">Xilinx Vivado</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/usafa-ece/ece281-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/usafa-ece/ece281-book/issues/new?title=Issue%20on%20page%20%2Flab/lab4.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lab/lab4.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab 4 - Moore Elevator Controller</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#authorized-resources">Authorized Resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-flow">Lab Flow</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-elevator-controller">Basic Elevator Controller</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-elevator-controller">Advanced Elevator Controller</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prelab">Prelab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab">Lab</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-functionality">Basic Functionality</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#add-files">Add files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-top-level">Complete top level</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation">Simulation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#deliver">Deliver</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-functionality">Advanced Functionality</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deliverables">Deliverables</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab-4-moore-elevator-controller">
<h1>Lab 4 - Moore Elevator Controller<a class="headerlink" href="#lab-4-moore-elevator-controller" title="Link to this heading">#</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id3">Overview</a></p>
<ul>
<li><p><a class="reference internal" href="#authorized-resources" id="id4">Authorized Resources</a></p></li>
<li><p><a class="reference internal" href="#lab-flow" id="id5">Lab Flow</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#prelab" id="id6">Prelab</a></p></li>
<li><p><a class="reference internal" href="#lab" id="id7">Lab</a></p>
<ul>
<li><p><a class="reference internal" href="#basic-functionality" id="id8">Basic Functionality</a></p></li>
<li><p><a class="reference internal" href="#advanced-functionality" id="id9">Advanced Functionality</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#deliverables" id="id10">Deliverables</a></p></li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>This lab is all about <strong>designing complex systems!</strong>
You will do this by integrating sequential and combinatorial building blocks
to design, test, and debug the <strong>Basic Elevator Controller</strong> from ICE5
before expanding functionality to an Advanced Elevator Controller.</p>
<p>In order to accomplish this, you will need to integrate modules from previous
in class exercises and labs. <strong>Start now and make steady progress!</strong></p>
<section id="authorized-resources">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Authorized Resources</a><a class="headerlink" href="#authorized-resources" title="Link to this heading">#</a></h3>
<p>For this lab, you may work in <strong>teams of two</strong> (including the prelab).
If you worked in a team for Lab 3,
you <strong>must</strong> work with a <em>different partner</em> for this lab.</p>
<p>You may seek help from any cadet or instructor,
not limited to this course, and reference any publication in its
completion. Online resources are acceptable. However, no resources
containing solutions to the course homework, labs, exams, quizzes, or in
class/out of class exercises are allowed.</p>
<p>Your work (and your code) must <strong>always</strong> be your own.
Normal documentation of all resources utilized is required.</p>
</section>
<section id="lab-flow">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Lab Flow</a><a class="headerlink" href="#lab-flow" title="Link to this heading">#</a></h3>
<p>This lab <em>iterates</em> to first implement a Basic Elevator Controller,
and then expand that to an Advanced Elevator Controller.</p>
<section id="basic-elevator-controller">
<h4>Basic Elevator Controller<a class="headerlink" href="#basic-elevator-controller" title="Link to this heading">#</a></h4>
<p>The <strong>initial phase</strong> of the lab only implements <a class="reference external" href="https://usafa-ece.github.io/ece281-book/ICE/ICE5.html">ICE5</a>
Basic Elevator Controller, shown in <a class="reference internal" href="#id1"><span class="std std-numref">Fig. 38</span></a></p>
<figure class="align-default" id="id1">
<img alt="../_images/lab4_basic_controller.png" src="../_images/lab4_basic_controller.png" />
<figcaption>
<p><span class="caption-number">Fig. 38 </span><span class="caption-text">Basic Elevator Controller user interface</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>The elevator’s current floor is shown on the second seven-segment display</p></li>
<li><p>The elevator takes 0.5 seconds to move between floors</p></li>
<li><p>The display updates according to the output</p></li>
<li><p>The elevator must not teleport… no skipping floors</p></li>
<li><p>Three push buttons are to be used for resets</p></li>
<li><p>The Master Reset button resets both the FSM <strong>and</strong> the clock.</p></li>
<li><p>The reset floor is <strong>floor 2</strong>.</p></li>
<li><p>LED 15 must be tied to the clock signal that drives the FSM.</p></li>
<li><p>You <em>may</em> use the other LEDs for debugging. For example, outputting the current floor in binary. Otherwise they should be grounded.</p></li>
</ul>
<p>This is the functionality who’s schematic you must design in the prelab.</p>
</section>
<section id="advanced-elevator-controller">
<h4>Advanced Elevator Controller<a class="headerlink" href="#advanced-elevator-controller" title="Link to this heading">#</a></h4>
<p>The <strong>final phase</strong> of the lab expands the basic functionality, see below.</p>
<p>This functionality should not be “hooked-up” in the Prelab.
However, the top level entity will reflect this advanced functionality from the start.</p>
</section>
</section>
</section>
<section id="prelab">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Prelab</a><a class="headerlink" href="#prelab" title="Link to this heading">#</a></h2>
<p>Create a Top Level Schematic showing your architecture
and <strong>submit one submission per team on Gradescope.</strong></p>
<p>This schematic must <em>only cover the Basic Elevator Controller functionality</em>.
You will be expected to update the schematic prior to implementing the
Advanced Elevator Controller.</p>
<p>This schematic should consist of the <strong>top_basys3</strong> entity, its I/O,
the various modules inside it, and the connecting signals and logic.</p>
<p>The top-level entity in <code class="docutils literal notranslate"><span class="pre">top_basys3.vhd</span></code> will be:</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Lab 4</span>
<span class="k">entity</span><span class="w"> </span><span class="nc">top_basys3</span><span class="w"> </span><span class="k">is</span>
<span class="w">    </span><span class="k">port</span><span class="p">(</span>
<span class="w">        </span><span class="c1">-- inputs</span>
<span class="w">        </span><span class="n">clk</span><span class="w">     </span><span class="o">:</span><span class="w">   </span><span class="k">in</span><span class="w"> </span><span class="kt">std_logic</span><span class="p">;</span><span class="w"> </span><span class="c1">-- native 100MHz FPGA clock</span>
<span class="w">        </span><span class="n">sw</span><span class="w">      </span><span class="o">:</span><span class="w">   </span><span class="k">in</span><span class="w"> </span><span class="kt">std_logic_vector</span><span class="p">(</span><span class="mi">15</span><span class="w"> </span><span class="k">downto</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">btnU</span><span class="w">    </span><span class="o">:</span><span class="w">   </span><span class="k">in</span><span class="w"> </span><span class="kt">std_logic</span><span class="p">;</span><span class="w"> </span><span class="c1">-- master_reset</span>
<span class="w">        </span><span class="n">btnL</span><span class="w">    </span><span class="o">:</span><span class="w">   </span><span class="k">in</span><span class="w"> </span><span class="kt">std_logic</span><span class="p">;</span><span class="w"> </span><span class="c1">-- clk_reset</span>
<span class="w">        </span><span class="n">btnR</span><span class="w">    </span><span class="o">:</span><span class="w">   </span><span class="k">in</span><span class="w"> </span><span class="kt">std_logic</span><span class="p">;</span><span class="w"> </span><span class="c1">-- fsm_reset</span>

<span class="w">        </span><span class="c1">-- outputs</span>
<span class="w">        </span><span class="n">led</span><span class="w"> </span><span class="o">:</span><span class="w">   </span><span class="k">out</span><span class="w"> </span><span class="kt">std_logic_vector</span><span class="p">(</span><span class="mi">15</span><span class="w"> </span><span class="k">downto</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="c1">-- 7-segment display segments (active-low cathodes)</span>
<span class="w">        </span><span class="n">seg</span><span class="w"> </span><span class="o">:</span><span class="w">   </span><span class="k">out</span><span class="w"> </span><span class="kt">std_logic_vector</span><span class="p">(</span><span class="mi">6</span><span class="w"> </span><span class="k">downto</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="c1">-- 7-segment display active-low enables (anodes)</span>
<span class="w">        </span><span class="n">an</span><span class="w">  </span><span class="o">:</span><span class="w">   </span><span class="k">out</span><span class="w"> </span><span class="kt">std_logic_vector</span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="k">downto</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>
<span class="k">end</span><span class="w"> </span><span class="nc">top_basys3</span><span class="p">;</span>
</pre></div>
</div>
<p>The entity contains ports you will not use for the Basic Elevator functionality,
but leave them in the schematic because you will need them for the Advanced Elevator.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Changing interfaces incurs massive engineering costs. This is because
<strong>interfaces are the promises you make to external systems.</strong></p>
<p>Even though we want to iterate (rather than “hit a home run”), we save
a lot of time by making our I/O large enough for advanced functionality from
the start. Imagine if you had to change the size of a std_logic_vector each
time you wanted to tweak something.</p>
<p>But there is a cost! First, this requires additional hardware that may never be used.
Second, you may waste effort solving problems that don’t actually need to be solved
because by the time you get to it the project requirements may have changed or
the implementation strategy may have changed.</p>
<p>Long story short, these sorts of decisions are hard and why Engineers get 💰</p>
</div>
<p>You need to include a clock divider module, and the remaining modules you
need will come from your previous in-class exercises and labs
(MooreElevatorController and sevenSegDecoder).</p>
<ul class="simple">
<li><p>Do not hand draw the schematic; rather, use a tool such as
<a class="reference external" href="https://excalidraw.com/">Excalidraw</a>, <a class="reference external" href="https://app.diagrams.net/">draw.io</a>, or PowerPoint.</p></li>
<li><p>The components inside your top level should remain black boxes.
The expectation is you will update this schematic at the end of this lab to reflect your final design.</p></li>
<li><p>Label <strong>all</strong> wires not connected to the top-level entity ports.
These will be additional signals you will create in your VHDL code.</p></li>
<li><p>Only turn on seven-segment display 2 (display 0 is the far right).
Force the others OFF by disabling their anodes. Reference earlier
activities regarding how to turn on/off displays.</p></li>
<li><p>LED 15 must be tied to the clock signal that drives the FSM.</p></li>
<li><p>You <em>may</em> use the other LEDs for debugging. For example, outputting the current floor in binary. Otherwise they should be grounded.</p></li>
<li><p>Just like in the last lab, the clock divider uses <em>generics</em> so that
you can redefine characteristics at instantiation. For instance, you
can redefine the number of times the clock divider divides a clock
for each instance of the module. Be sure to specify the value for
your clock divider to obtain 2 Hz. For an idea on how to accomplish
this, look at the generic mapping of the clock divider in ICE4 and Lab 3.</p></li>
<li><p>All component names should match the labels given to them
(ex: elevator_controller should be labeled elevator_controller)</p></li>
<li><p>All components should have their internal ports labeled so it is clear what a signal is being connected to.</p></li>
</ul>
</section>
<section id="lab">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Lab</a><a class="headerlink" href="#lab" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Fork and clone <a class="reference external" href="https://github.com/USAFA-ECE/ece281-lab4">Lab 4</a>.</p></li>
<li><p>Open the project by double clicking <code class="docutils literal notranslate"><span class="pre">elevator_fsm.xpr</span></code>.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Much of this code can be extracted from previous projects.
Rather than open another Vivado project (and the confusion that comes with it),
we suggest you <strong>view your previous project’s GitHub repository in your web browser</strong>.</p>
</div>
<section id="basic-functionality">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Basic Functionality</a><a class="headerlink" href="#basic-functionality" title="Link to this heading">#</a></h3>
<p>First, directly implement the pre-lab scematic.</p>
<section id="add-files">
<h4>Add files<a class="headerlink" href="#add-files" title="Link to this heading">#</a></h4>
<p>You will need to add VHDL files from your previous labs and ICEs to the project.
Reference <a class="reference internal" href="../appendix/vivado.html#manual-add-to-vivado-project"><span class="std std-ref">Manually add files to Vivado Project</span></a></p>
<p>You need to add any design sources that you plan to bring in as a module.
You do not need to bring in the testbench for these modules, since
we have tested them in previous labs. However, you can if you’d like.</p>
</section>
<section id="complete-top-level">
<h4>Complete top level<a class="headerlink" href="#complete-top-level" title="Link to this heading">#</a></h4>
<p>Using your Prelab drawing, complete the top-level module. Remember this basically involves:</p>
<ol class="arabic simple">
<li><p>Copying in component definitions</p></li>
<li><p>Creating additional signal wires</p></li>
<li><p>Instantiating your component instances and connecting all wires</p></li>
</ol>
<p>For the clock divider, what value for k_DIV do you need to produce a 2 Hz clock?</p>
</section>
<section id="simulation">
<h4>Simulation<a class="headerlink" href="#simulation" title="Link to this heading">#</a></h4>
<p><em>A brief discussion on testing philosophy.</em></p>
<p>The type of testing you choose results in a tradeoff of <strong>complexity</strong> vs.
how much <strong>confidence</strong> your test gives you that your design works.</p>
<p>Each component within your top_level already has been simulated and tested.
This is known as <strong>unit testing</strong> because you make sure that each
unit (component) does what it is supposed to.
Unit tests give you confidence that a single thing works and they are
quick to write and run. But unit tests don’t give you any information on how components
will or won’t work together.</p>
<p><strong>Integration testing</strong> tests if multiple units work together;
for example, does the clock_divider indeed provide a slow clock to the FSM?
While this type of testing is <em>awesome</em> for software design,
it’s difficult to do in hardware design.
Rather than use a VHDL simulation, we have done our integration testing
in previous ICEs and Labs by actually squirting to hardware.
This is more complex and takes more time than unit tests do, but in turn
we get greater confidence that the system works.</p>
<p>For Lab 4, the only thing that isn’t already tested is if the entire thing works!
This type of testing is <strong>end-to-end</strong> testing. If the test passes then we know
the entire system works. Unfortunately, end-to-end tests are also very complex to design and maintain.
Because of this <strong>you do not need to write a simulation test bench for this lab.</strong></p>
<p>As engineers, part of our job is to determine what is the appropriate level of confidence
and justify designing tests to meet that level. For this particular application,
the cost of simulating an end-to-end test is too high, so we will debug on hardware (yikes!).</p>
</section>
<section id="deliver">
<h4>Deliver<a class="headerlink" href="#deliver" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Don’t forget to uncomment lines in you XDC file.</p></li>
<li><p>Generate bitstream and program device!</p></li>
<li><p>Show it to your instructor</p></li>
<li><p>Commit to git and <strong>tag</strong> (see below)</p></li>
</ul>
<blockquote>
<div><p>Demonstrate your basic functionality to your instructor.</p>
</div></blockquote>
<p>After you have demonstrated basic functionality, you want to make sure you
save that result in case you ever need to go back to it. To do this we will
use <a class="reference external" href="https://www.atlassian.com/git/tutorials/inspecting-a-repository/git-tag">git tag</a>.</p>
<p>The normal flow:</p>
<ol class="arabic simple">
<li><p>Type <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code> to see the current state</p></li>
<li><p>Add all hardware files with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">src/hdl/*.vhd</span></code></p></li>
<li><p>Add your constraints file with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">src/hdl/*.xdc</span></code></p></li>
<li><p>Add you <code class="docutils literal notranslate"><span class="pre">.xpr</span></code> file.</p></li>
<li><p>Add any other files you need to commit (like your bitstream)</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code> again to make sure you are good.</p></li>
<li><p>Commit and push!</p></li>
<li><p>Make sure your github action looks good</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because we did not make a testbench to run, the GitHub Action simply runs
<a class="reference external" href="https://ghdl.github.io/ghdl/using/Synthesis.html#synthesis">GHDL Synthesis</a></p>
<p>This is an experimental feature.</p>
</div>
<p>Now for the annotated tag. The <code class="docutils literal notranslate"><span class="pre">-a</span></code> tells git to expect a message.
The message can be whatever you’d like, but please be sure to tag as <code class="docutils literal notranslate"><span class="pre">basicFunc</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>tag<span class="w"> </span>-a<span class="w"> </span>basicFunc<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Four floor controller&quot;</span>
</pre></div>
</div>
<p>Now push the tag to GitHub</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>push<span class="w"> </span>--follow-tags
</pre></div>
</div>
<p>You should now see the tag in your repository.</p>
<figure class="align-default" id="id2">
<img alt="../_images/lab4_git_tag.png" src="../_images/lab4_git_tag.png" />
<figcaption>
<p><span class="caption-number">Fig. 39 </span><span class="caption-text">A tag saved in a GitHub repository</span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>You can go back to this saved point at any time!</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>checkout<span class="w"> </span>basicFunc
</pre></div>
</div>
<p>The point of a tag is that you cannot edit the branch.
If for some reason you need to… use Google.</p>
<blockquote>
<div><p>Push your tagged basic functionality to GitHub.</p>
</div></blockquote>
</section>
</section>
<section id="advanced-functionality">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Advanced Functionality</a><a class="headerlink" href="#advanced-functionality" title="Link to this heading">#</a></h3>
<p><em>After</em> demonstrating your basic functionality <em>and after</em> pushing your <code class="docutils literal notranslate"><span class="pre">basicFunc</span></code> tag to GitHub,
it is time to implement advanced functionality!</p>
<ul class="simple">
<li><p>The elevator will travel from floor 1 to floor 16</p></li>
<li><p>Use the two left-most digits of the display to show the floor in decimal</p></li>
<li><p>All other functions will stay the same as in Basic Elevator Controller.</p></li>
</ul>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Revisit ICE6 for using TDM to drive a seven segment display.</p>
<p>Reference <a class="reference external" href="https://digilent.com/reference/basys3/refmanual#seven_segment_display">Basys3 Seven Segment Display</a></p>
</div>
<p><strong>Before</strong> you start to code, update your schematic. This schematic will be submitted in the Lab 4 Report.</p>
<blockquote>
<div><p>(Optional but recommended) Show your schematic to your instructor</p>
</div></blockquote>
<p><strong>After</strong> you have finished your schematic, make it work!</p>
<blockquote>
<div><p>Implement advanced functionality and demonstrate to instructor.</p>
</div></blockquote>
<p>Commit &amp; push your changes.</p>
<blockquote>
<div><p>Push changes for advanced functionality to GitHub.</p>
</div></blockquote>
</section>
</section>
<section id="deliverables">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Deliverables</a><a class="headerlink" href="#deliverables" title="Link to this heading">#</a></h2>
<p>Below are the deliverables and point distributions for the Lab 3:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Deliverable</p></th>
<th class="head"><p>Points</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Prelab</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-odd"><td><p>Basic Controller Demo</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>Advanced Demo</p></td>
<td><p>30</p></td>
</tr>
<tr class="row-odd"><td><p>Passing GitHub Action</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>Written Report</p></td>
<td><p>30</p></td>
</tr>
</tbody>
</table>
</div>
<p>The <strong>2 page max</strong> report will be very similar to Lab 3 Report requirements, with the following changes:</p>
<p>Things to Exclude:</p>
<ul class="simple">
<li><p>Do not include RTL schematics or discussion</p></li>
<li><p>There is no need to include a waveform</p></li>
</ul>
<p>Things to Add:</p>
<ul class="simple">
<li><p>Share your thoughts on modularity and abstraction</p></li>
<li><p>Discuss how your schematic changed (and what stayed the same) between Basic and Advanced Controllers</p></li>
<li><p>Discuss how you used TDM to get the Seven Segment Display functioning</p></li>
<li><p>How did you handle binary to decimal conversion for two displays?</p></li>
<li><p>What is the problem with the MASTER RESET?</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lab"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lab3.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab 3 - Thunderbird Turn Signal</p>
      </div>
    </a>
    <a class="right-next"
       href="lab5.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab 5 - Basic CPU</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#authorized-resources">Authorized Resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-flow">Lab Flow</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-elevator-controller">Basic Elevator Controller</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-elevator-controller">Advanced Elevator Controller</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prelab">Prelab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab">Lab</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-functionality">Basic Functionality</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#add-files">Add files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-top-level">Complete top level</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation">Simulation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#deliver">Deliver</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-functionality">Advanced Functionality</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deliverables">Deliverables</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By DFEC
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>